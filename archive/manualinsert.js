var data = [{"service_address":"1737 Appleton St","account_number":"11000160307","service_address":"1737 APPLETON ST","current_read_date":"9/23/2019","current_bill_date":"10/4/2019","penalty_date":"10/24/2019","current_bill_amount":"$1,010.44","previous_balance":"$921.47","current_balance":"$1,010.44","previous_read_date":"8/23/2019","last_pay_date":"10/10/2018","last_pay_amount":"-$105.00"},{"service_address":"715 N Patterson Park","account_number":"11000188715","service_address":"715 N PATTERSON PARK AVE","current_read_date":"9/25/2019","current_bill_date":"10/8/2019","penalty_date":"10/28/2019","current_bill_amount":"$653.12","previous_balance":"$574.92","current_balance":"$653.12","previous_read_date":"8/25/2019","last_pay_date":"7/23/2019","last_pay_amount":"-$927.55"},{"service_address":"1800 Appleton St","account_number":"11000161236","service_address":"1800 APPLETON ST","current_read_date":"9/25/2019","current_bill_date":"10/8/2019","penalty_date":"10/28/2019","current_bill_amount":"$6,885.97","previous_balance":"$6,703.87","current_balance":"$6,885.97","previous_read_date":"8/25/2019","last_pay_date":"4/26/2017","last_pay_amount":"-$514.40"},{"service_address":"717 N Curley St","account_number":"11000189976","service_address":"717 N CURLEY ST","current_read_date":"9/21/2019","current_bill_date":"10/4/2019","penalty_date":"10/24/2019","current_bill_amount":"$1,198.57","previous_balance":"$452.29","current_balance":"$1,198.57","previous_read_date":"8/21/2019","last_pay_date":"8/22/2019","last_pay_amount":"-$106.00"},{"service_address":"529 N Rose St","account_number":"11000182816","service_address":"529 N ROSE ST","current_read_date":"9/23/2019","current_bill_date":"10/4/2019","penalty_date":"10/24/2019","current_bill_amount":"$1,391.49","previous_balance":"$1,139.74","current_balance":"$952.49","previous_read_date":"8/23/2019","last_pay_date":"10/21/2019","last_pay_amount":"-$300.00"},{"service_address":"801 N Curley St","account_number":"11000190045","service_address":"801 N CURLEY ST","current_read_date":"10/5/2019","current_bill_date":"10/16/2019","penalty_date":"11/5/2019","current_bill_amount":"$493.58","previous_balance":"$461.29","current_balance":"$493.58","previous_read_date":"9/5/2019","last_pay_date":"7/23/2019","last_pay_amount":"-$1,041.96"},{"service_address":"17 Gorman Ave","account_number":"11000364148","service_address":"17 N GORMAN AVE","current_read_date":"9/18/2019","current_bill_date":"10/1/2019","penalty_date":"10/21/2019","current_bill_amount":"$1,844.31","previous_balance":"$1,799.30","current_balance":"$1,844.31","previous_read_date":"8/19/2019","last_pay_date":"4/12/2018","last_pay_amount":"-$980.00"},{"service_address":"512 S Pulaski St","account_number":"11000259316","service_address":"512 S PULASKI ST","current_read_date":"10/11/2019","current_bill_date":"10/23/2019","penalty_date":"11/12/2019","current_bill_amount":"$3,200.53","previous_balance":"$3,155.52","current_balance":"$3,200.53","previous_read_date":"9/11/2019","last_pay_date":"6/8/2018","last_pay_amount":"-$3,607.14"},{"service_address":"1522 N Fulton Ave","account_number":"11000159824","service_address":"1522 N FULTON AVE","current_read_date":"9/25/2019","current_bill_date":"10/8/2019","penalty_date":"10/28/2019","current_bill_amount":"$204.95","previous_balance":"$110.77","current_balance":"$100.00","previous_read_date":"8/25/2019","last_pay_date":"10/18/2019","last_pay_amount":"-$104.95"},{"service_address":"1719 Montpelier St","account_number":"11000171375","service_address":"1719 MONTPELIER ST","current_read_date":"9/21/2019","current_bill_date":"10/2/2019","penalty_date":"10/22/2019","current_bill_amount":"$632.61","previous_balance":"$598.59","current_balance":"$632.61","previous_read_date":"8/20/2019","last_pay_date":"6/8/2018","last_pay_amount":"-$437.72"},{"service_address":"1846 Wilkens Ave","account_number":"11000249789","service_address":"1846 WILKENS AVE","current_read_date":"9/15/2019","current_bill_date":"9/26/2019","penalty_date":"10/16/2019","current_bill_amount":"$681.60","previous_balance":"$528.81","current_balance":"$681.60","previous_read_date":"8/15/2019","last_pay_date":"7/23/2019","last_pay_amount":"-$963.19"},{"service_address":"1939 W North Ave","account_number":"11000161217","service_address":"1939 W NORTH AVE","current_read_date":"9/23/2019","current_bill_date":"10/4/2019","penalty_date":"10/24/2019","current_bill_amount":"$2,059.01","previous_balance":"$1,989.10","current_balance":"$2,059.01","previous_read_date":"8/23/2019","last_pay_date":"4/12/2018","last_pay_amount":"-$1,250.00"},{"service_address":"2324 E Federal St","account_number":"11000333064","service_address":"2324 E FEDERAL ST","current_read_date":"10/3/2019","current_bill_date":"10/15/2019","penalty_date":"11/4/2019","current_bill_amount":"$3,832.52","previous_balance":"$3,809.27","current_balance":"$3,832.52","previous_read_date":"9/3/2019","last_pay_date":"","last_pay_amount":"$.00"},{"service_address":"2408 E Lafayette Ave","account_number":"11000332824","service_address":"2408 E LAFAYETTE AVE","current_read_date":"9/27/2019","current_bill_date":"10/9/2019","penalty_date":"10/29/2019","current_bill_amount":"$882.94","previous_balance":"$859.69","current_balance":"$882.94","previous_read_date":"8/27/2019","last_pay_date":"5/4/2018","last_pay_amount":"-$2,151.51"},{"service_address":"2426 E Lafayette Ave","account_number":"11000332789","service_address":"2426 E LAFAYETTE AVE","current_read_date":"9/27/2019","current_bill_date":"10/9/2019","penalty_date":"10/29/2019","current_bill_amount":"$230.09","previous_balance":"$206.84","current_balance":"$230.09","previous_read_date":"8/27/2019","last_pay_date":"5/3/2018","last_pay_amount":"-$84.83"},{"service_address":"3325 E Baltimore St","account_number":"11000342393","service_address":"3325 E BALTIMORE ST","current_read_date":"10/1/2019","current_bill_date":"10/11/2019","penalty_date":"10/31/2019","current_bill_amount":"$2,499.55","previous_balance":"$2,383.39","current_balance":"$2,499.55","previous_read_date":"9/1/2019","last_pay_date":"6/8/2018","last_pay_amount":"-$1,985.86"}];
var WaterBill = require(__dirname + '\\getWaterBill.js')
data.forEach(function(water_bill) {
    new WaterBill().convertData(water_bill)
})

var knex = require('knex')({
    client: 'mysql',
    connection: {
        host: 'baltimore.c7o40no6tdyn.us-east-1.rds.amazonaws.com',
        user: 'admin',
        password: 'I09231990a',
        database: 'baltimore'
    }
});

var arr = []
data.forEach((water_bill) => {
    arr.push(knex('water_bill').insert(water_bill))
})
Promise.all(arr).then((lol) => {
    knex.destroy()
})
